name: Email Notification on New Issue

on:
  issues:
    types: [opened]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send email notification
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: ${{ secrets.NOTIFY_EMAIL }}
          password: ${{ secrets.NOTIFY_EMAIL_PASSWORD }}
          subject: "New GitHub Issue Opened: ${{ github.event.issue.title }}"
          to: ${{ secrets.NOTIFY_EMAIL }}
          from: GitHub Bot
          # Enable Markdown → HTML conversion for the html_body
          convert_markdown: true
          # Plain text fallback
          body: |
            A new issue has been opened!

            Repository: ${{ github.repository }}
            Title: ${{ github.event.issue.title }}
            Author: ${{ github.event.issue.user.login }}

            Issue Body:
            ${{ github.event.issue.body }}

            View Issue: ${{ github.event.issue.html_url }}
          # HTML version – uses Markdown syntax for nice rendering
          html_body: |
            <h2>A new issue has been opened!</h2>

            <p><strong>Repository:</strong> ${{ github.repository }}</p>
            <p><strong>Title:</strong> ${{ github.event.issue.title }}</p>
            <p><strong>Author:</strong> ${{ github.event.issue.user.login }}</p>

            <h3>Issue Body:</h3>
            ${{ github.event.issue.body }}

            <p><strong>View Issue:</strong> <a href="${{ github.event.issue.html_url }}">Click here</a></p>

            <hr>
            <small>Sent from GitHub Actions</small>
